/home/data3/Ali/Code/TabMixer-review/utility/dataset.py:130: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing 'df[col].method(value, inplace=True)', try using 'df.method({col: value}, inplace=True)' or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  for col in cat_cols: X[col].fillna(X[col].mode()[0], inplace=True)
########################################
load from local data dir /home/data3/Ali/Code/TabMixer-review/DATA/insurance+company(IO)/Preprocessed-2
# data: 7524, # feat: 85, # cate: 85,  # bin: 0, # numerical: 0, pos rate: 0.50
Epoch:   0%|          | 0/1000 [00:00<?, ?it/s]Epoch:   0%|          | 1/1000 [00:08<2:26:46,  8.82s/it]Epoch:   0%|          | 2/1000 [00:17<2:22:02,  8.54s/it]Epoch:   0%|          | 3/1000 [00:25<2:20:55,  8.48s/it]Epoch:   0%|          | 4/1000 [00:33<2:19:00,  8.37s/it]Epoch:   0%|          | 5/1000 [00:42<2:18:10,  8.33s/it]Epoch:   1%|          | 6/1000 [00:50<2:17:17,  8.29s/it]Epoch:   1%|          | 7/1000 [00:58<2:16:56,  8.27s/it]Epoch:   1%|          | 7/1000 [01:06<2:37:47,  9.53s/it]
2024-11-10 20:12:59.263 | INFO     | trainer:train:137 - load best at last from ./checkpoint
2024-11-10 20:12:59.267 | INFO     | trainer:save_model:248 - saving model checkpoint to ./checkpoint
2024-11-10 20:12:59.658 | INFO     | trainer:train:142 - training complete, cost 67.1 secs.
epoch: 0, test val_loss: 4.262856
epoch: 0, train loss: 91.7580, lr: 0.000100, spent: 8.8 secs
epoch: 1, test val_loss: 0.429780
epoch: 1, train loss: 73.6587, lr: 0.000100, spent: 17.2 secs
epoch: 2, test val_loss: 0.254264
epoch: 2, train loss: 10.9154, lr: 0.000100, spent: 25.6 secs
epoch: 3, test val_loss: 4.906982
EarlyStopping counter: 1 out of 5
epoch: 3, train loss: 134.1227, lr: 0.000100, spent: 33.8 secs
epoch: 4, test val_loss: 4.906982
EarlyStopping counter: 2 out of 5
epoch: 4, train loss: 202.4998, lr: 0.000100, spent: 42.0 secs
epoch: 5, test val_loss: 4.906982
EarlyStopping counter: 3 out of 5
epoch: 5, train loss: 200.7618, lr: 0.000100, spent: 50.2 secs
epoch: 6, test val_loss: 4.906982
EarlyStopping counter: 4 out of 5
epoch: 6, train loss: 203.3565, lr: 0.000100, spent: 58.5 secs
epoch: 7, test val_loss: 4.906982
EarlyStopping counter: 5 out of 5
early stopped
[0.8772578127207481]
